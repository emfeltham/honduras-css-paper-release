// short captions
#let in-outline = state("in-outline", false)
#show outline: it => {
    in-outline.update(true)
    it
    in-outline.update(false)
}
#let flex-caption(long, short) = locate(loc => 
    if in-outline.at(loc) { short } else { long }
)

#import"@preview/tablex:0.0.8": tablex, gridx, hlinex, vlinex, colspanx, rowspanx, cellx
#show figure: set block(breakable: true)

#let lbg = rgb("#63aaff")
#let org = rgb("#6d5319")

#text(size: 10pt)[
#figure(
    gridx(
        columns: (auto, auto, auto, auto, auto, auto, ),
        stroke: auto,
        cellx(colspan: 3)[],
        cellx(colspan: 3, align: center)[Difference],
        hlinex(start: 3, stroke: gray + 0.01em),
        cellx()[],
        vlinex(start: 2, stroke: 0.05em),
        cellx()[Variable],
        cellx()[Contrast],
        cellx()[TPR],
        cellx()[FPR],
        cellx()[J],
        hlinex(start: 1, stroke: 0.05em),
        hlinex(start: 1, stroke: 0.01em),
        cellx()[1],
        cellx()[Age (difference) \ #text(fill: lbg)[95% CI] \ #text(fill: lbg)[_P_]],
        cellx()[81.0 > 0.0],
        cellx()[0.253 \ (0.233, 0.273) \ 0.0],
        cellx()[0.026 \ (0.003, 0.049) \ 0.0289],
        cellx()[0.227 \ (0.198, 0.256) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[2],
        cellx()[Age (mean)],
        cellx()[91.99 > 14.5],
        cellx()[-0.284 \ (-0.31, -0.258) \ 0.0],
        cellx()[-0.023 \ (-0.046, -0.0) \ 0.0455],
        cellx()[-0.261 \ (-0.298, -0.224) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[3],
        cellx()[Cognizer-to-tie distance],
        cellx()[1.0 > No path],
        cellx()[0.092 \ (0.066, 0.118) \ 0.0],
        cellx()[0.082 \ (0.058, 0.105) \ 0.0],
        cellx()[0.011 \ (-0.026, 0.048) \ 0.5695],
        cellx()[4],
        cellx()[],
        cellx()[17.5 > 1.0],
        cellx()[-0.447 \ (-0.479, -0.416) \ 0.0],
        cellx()[-0.222 \ (-0.242, -0.201) \ 0.0],
        cellx()[-0.226 \ (-0.271, -0.181) \ 0.0],
        cellx()[5],
        cellx()[],
        cellx()[17.5 > No path],
        cellx()[-0.355 \ (-0.392, -0.318) \ 0.0],
        cellx()[-0.14 \ (-0.161, -0.119) \ 0.0],
        cellx()[-0.215 \ (-0.267, -0.163) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[6],
        cellx()[Degree (difference)],
        cellx()[1.0 > 0.0],
        cellx()[0.047 \ (0.016, 0.079) \ 0.003],
        cellx()[0.056 \ (0.029, 0.084) \ 0.0001],
        cellx()[-0.009 \ (-0.053, 0.035) \ 0.6918],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[7],
        cellx()[Degree (mean)],
        cellx()[0.88 > 0.0],
        cellx()[-0.195 \ (-0.233, -0.157) \ 0.0],
        cellx()[-0.148 \ (-0.171, -0.125) \ 0.0],
        cellx()[-0.047 \ (-0.1, 0.006) \ 0.0805],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[8],
        cellx()[Education],
        cellx()[Same > Mixed],
        cellx()[-0.001 \ (-0.021, 0.02) \ 0.9337],
        cellx()[0.007 \ (-0.014, 0.029) \ 0.5055],
        cellx()[-0.008 \ (-0.037, 0.021) \ 0.5826],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[9],
        cellx()[Gender],
        cellx()[Mixed > Men],
        cellx()[0.038 \ (0.015, 0.061) \ 0.001],
        cellx()[-0.138 \ (-0.16, -0.116) \ 0.0],
        cellx()[0.176 \ (0.144, 0.209) \ 0.0],
        cellx()[10],
        cellx()[],
        cellx()[Women > Men],
        cellx()[0.067 \ (0.046, 0.089) \ 0.0],
        cellx()[-0.033 \ (-0.057, -0.009) \ 0.0075],
        cellx()[0.1 \ (0.07, 0.13) \ 0.0],
        cellx()[11],
        cellx()[],
        cellx()[Women > Mixed],
        cellx()[0.029 \ (0.008, 0.051) \ 0.0066],
        cellx()[0.105 \ (0.084, 0.127) \ 0.0],
        cellx()[-0.076 \ (-0.106, -0.046) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[12],
        cellx()[Indigeneity],
        cellx()[Mestizo > Indigenous],
        cellx()[0.015 \ (-0.012, 0.042) \ 0.2694],
        cellx()[0.002 \ (-0.022, 0.025) \ 0.8719],
        cellx()[0.013 \ (-0.025, 0.052) \ 0.4945],
        cellx()[13],
        cellx()[],
        cellx()[Mixed > Indigenous],
        cellx()[0.005 \ (-0.024, 0.034) \ 0.7345],
        cellx()[-0.007 \ (-0.031, 0.017) \ 0.5579],
        cellx()[0.012 \ (-0.028, 0.053) \ 0.5596],
        cellx()[14],
        cellx()[],
        cellx()[Mixed > Mestizo],
        cellx()[-0.01 \ (-0.033, 0.012) \ 0.3619],
        cellx()[-0.009 \ (-0.031, 0.013) \ 0.4146],
        cellx()[-0.001 \ (-0.033, 0.03) \ 0.9345],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[15],
        cellx()[Relation],
        cellx()[Personal Private > Free Time],
        cellx()[-0.095 \ (-0.116, -0.075) \ 0.0],
        cellx()[-0.057 \ (-0.078, -0.035) \ 0.0],
        cellx()[-0.038 \ (-0.068, -0.009) \ 0.0095],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[16],
        cellx()[Religion],
        cellx()[Same > Mixed],
        cellx()[0.023 \ (0.002, 0.044) \ 0.0291],
        cellx()[0.037 \ (0.016, 0.059) \ 0.0007],
        cellx()[-0.014 \ (-0.044, 0.015) \ 0.3466],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[17],
        cellx()[Wealth (difference)],
        cellx()[1.0 > 0.0],
        cellx()[-0.335 \ (-0.365, -0.305) \ 0.0],
        cellx()[-0.179 \ (-0.198, -0.159) \ 0.0],
        cellx()[-0.157 \ (-0.199, -0.114) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[18],
        cellx()[Wealth (mean)],
        cellx()[1.0 > 0.1],
        cellx()[0.263 \ (0.236, 0.29) \ 0.0],
        cellx()[0.183 \ (0.159, 0.207) \ 0.0],
        cellx()[0.08 \ (0.043, 0.118) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[19],
        cellx()[Within-tie distance],
        cellx()[1.0 > No path],
        cellx()[  \  \  ],
        cellx()[0.157 \ (0.132, 0.182) \ 0.0],
        cellx()[  \  \  ],
        cellx()[20],
        cellx()[],
        cellx()[19.0 > 1.0],
        cellx()[  \  \  ],
        cellx()[-0.386 \ (-0.404, -0.367) \ 0.0],
        cellx()[  \  \  ],
        cellx()[21],
        cellx()[],
        cellx()[19.0 > No path],
        cellx()[  \  \  ],
        cellx()[-0.229 \ (-0.246, -0.211) \ 0.0],
        cellx()[  \  \  ],
        vlinex(start: 2, stroke: 0.05em),
        hlinex(start: 1, stroke: 0.05em),
    ),
    caption: flex-caption(
        [Contrasts for tie chracteristics. Each accuracy measure represents the difference between the predicted value for each level of the contrast. 95% confidence intervals are presented in parentheses below the mean estimates. The corresponding p-values are presented below the intervals, and are rounded to 3 digits.],
        [Contrasts for tie chracteristics.]
    ),
    kind: table
)
]
