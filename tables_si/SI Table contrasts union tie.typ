// short captions
#let in-outline = state("in-outline", false)
#show outline: it => {
    in-outline.update(true)
    it
    in-outline.update(false)
}
#let flex-caption(long, short) = locate(loc => 
    if in-outline.at(loc) { short } else { long }
)

#import"@preview/tablex:0.0.8": tablex, gridx, hlinex, vlinex, colspanx, rowspanx, cellx
 
#let lbg = rgb("#63aaff")
#let org = rgb("#6d5319")
 
#figure(
    gridx(
        columns: (auto, auto, auto, auto, auto, auto, ),
        stroke: auto,
        cellx(colspan: 3)[],
        cellx(colspan: 3, align: center)[Difference],
        hlinex(start: 3, stroke: gray + 0.01em),
        cellx()[],
        vlinex(start: 2, stroke: 0.05em),
        cellx()[Variable],
        cellx()[Contrast],
        cellx()[TPR],
        cellx()[FPR],
        cellx()[J],
        hlinex(start: 1, stroke: 0.05em),
        hlinex(start: 1, stroke: 0.01em),
        cellx()[1],
        cellx()[Age (difference) \ #text(fill: lbg)[95% CI] \ #text(fill: lbg)[_P_]],
        cellx()[81.0 > 0.0],
        cellx()[0.264 \ (0.245, 0.283) \ 0.0],
        cellx()[0.024 \ (0.001, 0.047) \ 0.0369],
        cellx()[0.24 \ (0.213, 0.267) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[2],
        cellx()[Age (mean)],
        cellx()[91.99 > 14.5],
        cellx()[-0.253 \ (-0.278, -0.229) \ 0.0],
        cellx()[-0.067 \ (-0.089, -0.044) \ 0.0],
        cellx()[-0.187 \ (-0.222, -0.152) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[3],
        cellx()[Cognizer-to-tie distance],
        cellx()[1.0 > No path],
        cellx()[0.104 \ (0.081, 0.128) \ 0.0],
        cellx()[0.153 \ (0.13, 0.176) \ 0.0],
        cellx()[-0.049 \ (-0.082, -0.015) \ 0.0043],
        cellx()[4],
        cellx()[],
        cellx()[17.5 > 1.0],
        cellx()[-0.451 \ (-0.481, -0.421) \ 0.0],
        cellx()[-0.356 \ (-0.375, -0.338) \ 0.0],
        cellx()[-0.095 \ (-0.137, -0.052) \ 0.0],
        cellx()[5],
        cellx()[],
        cellx()[17.5 > No path],
        cellx()[-0.347 \ (-0.38, -0.313) \ 0.0],
        cellx()[-0.203 \ (-0.218, -0.189) \ 0.0],
        cellx()[-0.143 \ (-0.191, -0.096) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[6],
        cellx()[Degree (difference)],
        cellx()[17.0 > 0.0],
        cellx()[0.028 \ (-0.001, 0.057) \ 0.0547],
        cellx()[0.03 \ (0.004, 0.056) \ 0.0247],
        cellx()[-0.002 \ (-0.043, 0.039) \ 0.9323],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[7],
        cellx()[Degree (mean)],
        cellx()[15.99 > 1.0],
        cellx()[-0.185 \ (-0.218, -0.151) \ 0.0],
        cellx()[-0.039 \ (-0.064, -0.013) \ 0.0033],
        cellx()[-0.146 \ (-0.193, -0.099) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[8],
        cellx()[Education],
        cellx()[Same > Mixed],
        cellx()[0.0 \ (-0.02, 0.02) \ 0.9934],
        cellx()[0.01 \ (-0.012, 0.031) \ 0.3791],
        cellx()[-0.009 \ (-0.038, 0.019) \ 0.5132],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[9],
        cellx()[Gender],
        cellx()[Mixed > Men],
        cellx()[0.036 \ (0.014, 0.058) \ 0.0011],
        cellx()[-0.142 \ (-0.164, -0.12) \ 0.0],
        cellx()[0.178 \ (0.147, 0.209) \ 0.0],
        cellx()[10],
        cellx()[],
        cellx()[Women > Men],
        cellx()[0.061 \ (0.04, 0.081) \ 0.0],
        cellx()[-0.046 \ (-0.07, -0.022) \ 0.0002],
        cellx()[0.107 \ (0.077, 0.136) \ 0.0],
        cellx()[11],
        cellx()[],
        cellx()[Women > Mixed],
        cellx()[0.024 \ (0.004, 0.045) \ 0.0189],
        cellx()[0.096 \ (0.075, 0.117) \ 0.0],
        cellx()[-0.072 \ (-0.1, -0.043) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[12],
        cellx()[Indigeneity],
        cellx()[Mestizo > Indigenous],
        cellx()[0.017 \ (-0.008, 0.042) \ 0.1896],
        cellx()[-0.001 \ (-0.024, 0.022) \ 0.9287],
        cellx()[0.018 \ (-0.018, 0.054) \ 0.3237],
        cellx()[13],
        cellx()[],
        cellx()[Mixed > Indigenous],
        cellx()[0.007 \ (-0.019, 0.034) \ 0.5878],
        cellx()[-0.01 \ (-0.033, 0.014) \ 0.4242],
        cellx()[0.017 \ (-0.021, 0.055) \ 0.3759],
        cellx()[14],
        cellx()[],
        cellx()[Mixed > Mestizo],
        cellx()[-0.01 \ (-0.031, 0.012) \ 0.3787],
        cellx()[-0.009 \ (-0.03, 0.013) \ 0.4346],
        cellx()[-0.001 \ (-0.031, 0.029) \ 0.9456],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[15],
        cellx()[Relation],
        cellx()[Personal Private > Free Time],
        cellx()[-0.093 \ (-0.113, -0.073) \ 0.0],
        cellx()[-0.047 \ (-0.068, -0.025) \ 0.0],
        cellx()[-0.046 \ (-0.075, -0.018) \ 0.0014],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[16],
        cellx()[Religion],
        cellx()[Same > Mixed],
        cellx()[0.067 \ (0.046, 0.088) \ 0.0],
        cellx()[0.069 \ (0.048, 0.089) \ 0.0],
        cellx()[-0.002 \ (-0.032, 0.028) \ 0.9106],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[17],
        cellx()[Wealth (difference)],
        cellx()[1.0 > 0.0],
        cellx()[-0.346 \ (-0.375, -0.318) \ 0.0],
        cellx()[-0.174 \ (-0.193, -0.154) \ 0.0],
        cellx()[-0.173 \ (-0.212, -0.133) \ 0.0],
        hlinex(start: 1, stroke: 0.01em),
        cellx()[18],
        cellx()[Wealth (mean)],
        cellx()[1.0 > 0.1],
        cellx()[0.245 \ (0.22, 0.271) \ 0.0],
        cellx()[0.161 \ (0.137, 0.185) \ 0.0],
        cellx()[0.085 \ (0.049, 0.12) \ 0.0],
        vlinex(start: 2, stroke: 0.05em),
        hlinex(start: 1, stroke: 0.05em),
    ),
    caption: flex-caption(
        [Contrasts for tie characteristics, union. Each accuracy measure represents the difference between the predicted value for each level of the contrast. 95% confidence intervals are presented in parentheses below the mean estimates. The corresponding p-values are presented below the intervals, and are rounded to 5 digits.],
        [Contrasts for tie characteristics, union]
    ),
    kind: table
) <contrast_tie_union>
